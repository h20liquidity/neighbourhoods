import * as path from "path";  
import { solidityKeccak256,  hexlify } from "ethers/lib/utils";
// import { ExpressionConfig, rlc, MetaStore } from "@rainprotocol/rainlang";
import fs from "fs"  
import { ExpressionConfig, MetaStore, getRainlangCompletion, rainlangc } from "@rainprotocol/rainlang";
import { BigNumber, ethers } from "ethers";  
import axios from "axios" ;
import { Alchemy, Network } from "alchemy-sdk"; 

/**
 * @public
 * Builds sources and constants from a rainlang expression.
 *
 * @param expressionString - rainlang expression
 * @returns sources and constants
 */
// export const standardEvaluableConfig = async (
//     expression: string
//   ): Promise<ExpressionConfig> => { 
//     console.log("opmeta :",opMetaHash) ;
//     const store = new MetaStore();
//     await store.updateStore(opMetaHash);
  
//     return await getRainlangCompletion(expression, store)
//       .then((expressionConfig) => {
//         return expressionConfig;
//       })
//       .catch((error) => {
//         throw new Error(JSON.stringify(error, null, 2));
//       });
//   }; 
  
  /**
   * @returns A hex string which is the keccak256 hash of opmeta
   */
  export const getOpMetaHash = (): string => {
    return solidityKeccak256(["bytes"], ["0xff0a89c674ee7874a400591126789ced5d6d6fdc3612fe9e5f4118012ee9ad1cefba497cfdd6a6f7125c9b14692e87439a03b8127797b0246e44c9f6f6d0ff7e3343ea5dd46adffc86fd90d89648917ce699e1901c929f9f30f63ff8c7d849cc2371f21d3b0984af02e14d5ebe3a19993781d03ebef991de30ce74287dc1d48c4d65aa99ca52fc9d33c8824fd8150f33c19ef178952e643c672a66e942309d72fff2f969fe55b514098f03f8f0677a9057a45619c893a43647ad2e3f4039320ec40d4b15a3542c113cc0e266898a4eab79b09658ccc5888d5f7eb1cfff18b94b0d453c4f175dc5becba2a9488aa643d9582a15696ad159f0d988bd2ecaa59f5f2c08325e669426afc5c99227508b5424ba824cb59655745496f8e2a478f587fdcd94f5470e7496da42c6f6090f25d7820a38215992b43117e5691042c42e42fc95de30ad22c1d2248b7d9e8ac02043880ca404081280e42c16d7f50c47ae1c902ba3fef450c1b94877e396af962b6f00c16e962132ec7cd224d82f282b1eb30c1882cc303422ba5c302d9015a96063365dc10f2d7f172685ee20ced95e50a4cf0f07e5a20314db5a6c6cd1742734fe82cb3894f1a5b74c00c6263e1ff9a5d0ec6f02b40e5ac97e4d7928be9f41532c0e05d9fc4b4a0012d5a4786ff2efb2f709f74341dff89366540a253599306d227416a66c0a2d085071cb520e85f20c2a53d18d4a8379104075342a1556cd5497920f26b6c6ea7bbc52ff46194106ac92d0502c44a2695bf0d416752dc3904d896632d84d398c409d8257712a6ed2a6c0dfc65a242043d0099b82f902aa442a515854d087c2c2f92acca298449aa86b43885c5e9b5857f39d9d4c2594bfa5c53b6b23da8f9b67aaeb2db85e3431fc1521326a80afc9778999885399881255ca7fcafea5c52c0bd94c254cc77ca9172a4d1156c433e4a869fe42f897f4888552932b9481904061d5950c40659c26692bb4cf6a68ef0bae52346daa0d651a3eb46cabb2ac4e3dcab52314790debb2bacdce14e11aaefc0eec672a0c3c879eff2212a05c84e8870a600a98cf017c7505842377cbd4df586afc3bc7026aa6995e0a5fce24fa62ab5c24c6ef316e10e6ba9641bad88c9416b30e9cc7e75bda808a4e26a4574814201836daed9c8d510926438aa356f63b67061f5d948a187796fa7ac4fe32a44c2b57176b8ba65ac1ac2df7db117b35a45ce3e17924e2ae82df92ec6dcf691293539ac52e47f47ca8ee3478907f6d239da2afd67b64bd44db022f61702106eb9bab564ff2cc9d8610d4abdbbb32ea968ac87a53a5ed23c396c5a8a416ce6b992e98cea65e9980d4b474a334f851e857556ce866839c3542964e21bbbaeef1106e19743d74b1bb4a8d0b6dcac5d0cde3d743ca729b996d284979ee19214b24f2c455c770060369f43f717c308b9d1e62a0bceb850c5b63820f8691f4ce5a96989502324c4e81da713e483764cdc0010a4d6f1f482c5f33a91980f510f8b9863395e7e4b97fe0f11cf37db6ee543581af22f8168d0068c491cc99c7c6273bd1aef14d9a0ff8337cf4c0bc5c33122a24dd3d0e2a5ea3b84a3a0d777cba4171f2deb0d93d4900e8c44db20f1881b69de1334711d83aaf55c44fa84285858f6948a8d1b1021dc26ebcd93fd44c7f9a3bc635eb4f3ef4e6b69feab7de0463b26e2f6d32d44b3bf6328fbe972155c61e46254e9dc36a78918854b2eaf68d60dc8ccc37c4077b019c8e715492247cc560c85c5108a321a8169206968c2665b7f6838651932a67275e3b3562a842a4ab652725f1795e1816326a4281f30695c6354973b6f948be4396d43c9710bba640fe81f31ecfb482ae50a62b76297c9f5f4e5ebe7a6e67582bee4169ce9a33827b1a3bd218dddd418388262fa187de5c215fdfb142bac6fd22f1bdf1f8e54b6fca431e839955b3a67cfe2e5202daa6b053547ffdf006f301a1513ae619f77d059edb868ab59f695aaa8767a764874fc0da2a6fb01441e5ec3adfda84dded69b4e503bfa67e4b8b1a52d29d62c29943ca6ddf9bc61b4b6852c860af7671473d737bc2cfac2bfc9cbd60936e7fb8dff76bf4464395b7590df29ebf6193e7dbbbd03b32770fbe77c1e9ad0d8d83dbc0b4410c9f9c6d637f26678fcffa6c694b4a00d7e19caa94879ece96cbb0e547e5489bb71d40df2768b747ca367e0d50f90a4bd5f2f2d6dc7801994dbd294b1183bbc772df9d6481dd3efac90e590c965d95ed43a4f720987f57e00fd09b97e7e3734f5dc7e5727c6da19330a3d725c4988561b70a25c729ad1d25dc4f0f16359117b08549e969f8ebc9789b2e0cb21dfb304bb50a84bd1cc374c4a11ea01b1c7b0430ef6fdc51e0d71364a7b3a43d972fbe66189590e22cfeacb2f404a84d29e62e5dac464c9e8a533607d711e311d205a0fdbb48d429fb20ae68095fcef22fd8b918cdce0ea6ec115f4d8567aa361cb9b30ee412d37a276639731ba0bdc9924400d36218325c0936e7ba61042c150f8640e730a198380319e6ba00529cb7ccd4e9eed6711a2affd233d3a5aeb00e8ad6b04851fa7c8d6863951c364765cbf2a8acfe78b77258d415b353ad34a666b148af5572c9defe3844a2c363630c8a34dd9ff268d90d64078e458ec150b6916b55b70a658c3114ac4014cb6bfe6d6aec42192c61b335df0781665116a67219e65194c04fa0e74224a7ec9379e083f680dd11129fb240f832e221ce71424bc55c242336cd40f1c0abe32c92340d3b55fb0b335933853179b853851d52d659845205643d921745e623dee38bfc01beb3c9ca77f8c0b9662caf5a41fd12a3d42ab2b7a2cc39a0c108636c1c0fc3d5518e5bc8118584b8f7443fb7ba7d2e758f48a0435baa6b1cc5827e09ee2f98427d1c31713a3f6537ecbf6c05ff7e3f4a6b4b6901b84e6945fca6d5378950f8b64785d732ca22144cc3981e6de81d499324563590f8c0295ed95affaf8957c647f1de33f1cab8215ee98e998a54cbf179c3433fc3486eb0b72ac84255136eddf21e85b4ad90947b7d1ab06ecae46703bf0499bc3b8a604f2200985d22d0d9b465f5b2294dd9a1048e16ee4e2547d2a97bf853b7287ddcdd34be68cf24d11b10c94cde88001c488953244544d5bb5c9014083fbe28ffbc06290bd4430d0236337d46809b0934ff5e5714cd8f7959768ecb04a14c056d0830150f3a63d427b570f3361930baf3d5f9c579498791bb869aa7b8f3ab33cee7ed8c8d195604ab942dcd3eb03c0383ff16f9cc1b86f1cf4275cd965ca7c5c645f039ba77324005d7d47f50dd1395c581972dd7d63d50d7b1a93d65c1b6546b4faf55cc80c0bed418fb192aad5dfb03ce06577d8d161e700ba66b762757142f58c123e91f44612a7154c534d0869b9a8fa47c08a4cce7de0a2b57f273748b746e0d5e0a16c748d1f7ef7fd65d74c668644af66e33729a3de25e9f69c7e96e93aca62fa6b8541dadfa51812a6a50f3a2aa14b261a92571d8bbdd7586c7ad709ceaeac84c261afdd8d8c3d5345b055c4102980b2f852249680bb0596623db2f6ea4c6d8df588c9808b5b00b9e9a96e51aab0247b7780bb7b827665d70188278b2b54c6d02d6cfdd3bf94888568656f6143e0edd78c1018a29af50440bdc2463d3d5c4da103c3e3f4f4cca034659f46de7f948dbb3f32d3d5057810446cb38b8af02e3a7716b233442f4ad6f96da6a969b67766f785e7805d217c885e135987119eea90654fa0cfaa31d0fd001aa39b9f835e3a197aad69c938a40b0c2d022c41e656279d958e437cb6f9598094dbaf3625cd942641bb7621c2d4ff695870dee511b5f9c1d8a7604f578438767b2634cc55737e6d0530f30eb83ac396db9277423423727edd1aa575eedcfaa234e2eb1dae8160ffd996ed36ef5a8fbe01bb30bbba23aa596d52cbe3d6048d7a3692aa6de24c04f5ab5c2fcb13a5c30c95da8d73c75ca416ad2809645ab7a40258aa4192eeb551301c682e93b305c3bda7eed991e64049f556ed442011de76d51170bdb076f7ba252ee11936b7b1add125826538f5fcd7b567f102c9ec87401ed913ee3d08f802b89f6df1c98b21ae1c27b39d1531d488fccb82b1f8a1dcc18dc0c476f83d8bb2e6657624d00b53e547d215b0b38ff91220cac8b0c5f0146a6ec7aa160e4d68d5f3e1151b3ba2a61e440a11b77732b90ee8413e1d007544ff04d7aadfa91d1a7ec03320c274fae791218d3faa878d6172383f075c4c934b437a6999b1086df4b187ac7a9d55d97d2de7f4a6193d740d23a32b181c954c63c593520c9747e2c817d3dc3a53e1c174113172a78e0984d7a419b854ab5a2622b06cbd8a08106abec6b1f98b53228f4e2049ce88149dcf8d8f6a958a17b416e087ef2c1eb1c35bb0f9779b446e5e64241ad13f02122c1e3610e8409e17ffa547f4dd26737ec1bb67afef4e963f62ae6ee20550459c6adbeb282f298bd6037c3dc31d35dde5e6fb91328d8ea3e54c2d6f8c1d103866a6e5cd907af8ea13b988b1051f3f1d91a507c1545b4e4f16830a146af8165a063f0a850e9eff8fb03cdd6bbe0e57688c76488fbe2c210b565fb64581b9e7e939f6248c1e8c89fd51df3e7b630eb0b10b798654ed09e99b57837d19ed7715db16759ace53cc6e35cb906b7c2c6d93daff8f1331ea94c331ece95d1e6df4e72975f9ac3aca72ba6c13f4d20c76f278f4d1ad073f64ffda05fb5c620123a023c07654649f76cba672788a8f9ce904113f000adf13a3686e54b27da84bd1352c5f1c2cec55439c360832b91e0513749651b6a799efc5ce15696a9baa25d13c5c50f95c3df8e8b271b081ba4986f0bab08d4ee0ec3977dfbc22a393a7ac99c0251de5b06b90c8f84b8df84e80dfaaeb2a415ff5daabd8903cfef43d8afb4a71852555d4f3a0a783301f78582ab2410c954a94bef6ae25d7100bd38eba121ec8fad7332de63de1f20efa709ce6c957f8e197de9605d5e59e9fcb8861a7ab55df4f5bb40de56ea3cdc0b31a75a6c5ad6fbfcac0bb3da8987210e2eb17e18c5d0123f62ae4dd6ce50dcbb1e5d5161d0b8c120b7550905f22d111197311a177b8a467c05be68d741a264126c62967cfce73b5cc19cd1e108e6940badc2808ed1e3ec57f8faa7c9c1c84795dfdb19352514604aaf3a95cebeaa1c94f2309b483f312c2bd35dcdc4d7ccbcbecf8decb4b1b681a66deb584f72ec1434f0baaad2f71582b5edc3b3bd2c6be1a72fe495680d1928e61b53321c959a45a71ad3d12730597158fac0b0006746ce566811ed312e961c1ecf8fe2e8508092fb95939070839c75a67c73d3943d90ff1315f1697c9bc11965abb63c8d6a8bf3958a834ad608a5aa912ef8dd9163a235f2ff80f7f0717629562f4c5ccc92cba438b999fc5d1099a2f80f20a8b9c9299f6ab9c450cbda71c8d5d8f5bd93178aeb7612f2ba5807a1de983da87c1bb67f27e0f0b771eb3c2cfa9ad252bc5213d24322b58183b451f057d7313cd44427ed52097e25f5fe4bd59e7b42a3f01152807b6d121807a7300e23a69638e6c253572afccb6f79baddbdd05f46ecf339fe373e5b7f5386e364e02d0ffbb537654c8a6a6f76ee9bacf8f69bdab3e119ea7778d9978db07b4c80d10146727b19120e221e75491e90cbc3e73d340c61941ed67b2807090150691edf0d1f898adf121fc7ebf9787e083e9eefc04710cd2d1c998ec2beef04eeb0a984502773d7d9d9ca74562067eded3f340cc993304c221261273c72237cb87b636d9336887eb5393689e45e87101d64e385a96b286a67744dbadcdd29239c8af0a67202d0755b44a42077b957daa26b9cfd50cd31bc167c84082f8fdee1ac7bfa52d7de48d302062d35a57dc7685708a32e76c55af96a17c59577bf8cdc4563d5d7948c49bec3138346349d8db7a1609c7657b91778b3a0dbe081459a0cda2ffa702ed9488455bfd6f98a0d40692c591ca888de246dd34be931b02ba7169f733cda7b53fd72176add32a43bc9f4a7d40ccf6ea3ebce96014f2d348505f4121297639e3eada9307da0b87a0af399cb8ced9971bc685d537349435b5a5dd971b0bdb68a38a8fa20b5565040a10dd8926643bac1a08bcbdff673194879316c67385ec4d95b259d5fd5b9be52ebaf99bb38c8bee93e1aa7351a9bba33ba8a9e34872a37585faa9c74ab6bda54575b6a59223cdcb04b7bf2e5c9ff01989717d2011bffe5282f43e495b402706170706c69636174696f6e2f6a736f6e03676465666c617465"]);
  };
  
  /**
   * @returns Keccak256 OpMetaHash
   */
  export const opMetaHash = getOpMetaHash(); 

export const fetchFile = (_path: string): string => {
    try {
      return fs.readFileSync(_path).toString();
    } catch (error) {
      console.log(error);
      return "";
    }
  };   


// async function test(){ 

//     //Building Expression
//     const strategyExpression = path.resolve(
//         __dirname,
//         "./src/2-price-update.rain"
//       ); 
  
//     const strategyString = await fetchFile(strategyExpression);  
  
//     // const arbCounterParty = contractConfig.contracts[network].zeroexorderbookinstance.address 
//     // console.log("arbCounterParty: ",arbCounterParty)
      
//     console.log("here : ")
//     const { sources, constants } = await standardEvaluableConfig(strategyString)   

//     console.log("sources : " , sources )

// } 
// test() 

// async function redOpMeta(){
//   let str = "FF0A89C674EE7874A400591126789CED5D6D6FDC3612FE9E5F4118012EE9AD1CEFBA497CFDD6A6F7125C9B14692E87439A03B8127797B0246E44C9F6F6D0FF7E3343EA5DD46ADFFC86FD90D89648917CE699E1901C929F9F30F63FF8C7D849CC2371F21D3B0984AF02E14D5EBE3A19993781D03EBEF991DE30CE74287DC1D48C4D65AA99CA52FC9D33C8824FD8150F33C19EF178952E643C672A66E942309D72FFF2F969FE55B514098F03F8F0677A9057A45619C893A43647AD2E3F4039320EC40D4B15A3542C113CC0E266898A4EAB79B09658CCC5888D5F7EB1CFFF18B94B0D453C4F175DC5BECBA2A9488AA643D9582A15696AD159F0D988BD2ECAA59F5F2C08325E669426AFC5C99227508B5424BA824CB59655745496F8E2A478F587FDCD94F5470E7496DA42C6F6090F25D7820A38215992B43117E5691042C42E42FC95DE30AD22C1D2248B7D9E8AC02043880CA404081280E42C16D7F50C47AE1C902BA3FEF450C1B94877E396AF962B6F00C16E962132EC7CD224D82F282B1EB30C1882CC303422BA5C302D9015A96063365DC10F2D7F172685EE20CED95E50A4CF0F07E5A20314DB5A6C6CD1742734FE82CB3894F1A5B74C00C6263E1FF9A5D0EC6F02B40E5AC97E4D7928BE9F41532C0E05D9FC4B4A0012D5A4786FF2EFB2F709F74341DFF89366540A253599306D227416A66C0A2D085071CB520E85F20C2A53D18D4A8379104075342A1556CD5497920F26B6C6EA7BBC52FF46194106AC92D0502C44A2695BF0D416752DC3904D896632D84D398C409D8257712A6ED2A6C0DFC65A242043D0099B82F902AA442A515854D087C2C2F92ACCA298449AA86B43885C5E9B5857F39D9D4C2594BFA5C53B6B23DA8F9B67AAEB2DB85E3431FC1521326A80AFC9778999885399881255CA7FCAFEA5C52C0BD94C254CC77CA9172A4D1156C433E4A869FE42F897F4888552932B9481904061D5950C40659C26692BB4CF6A68EF0BAE52346DAA0D651A3EB46CABB2AC4E3DCAB52314790DEBB2BACDCE14E11AAEFC0EEC672A0C3C879EFF2212A05C84E8870A600A98CF017C7505842377CBD4DF586AFC3BC7026AA6995E0A5FCE24FA62AB5C24C6EF316E10E6BA9641BAD88C9416B30E9CC7E75BDA808A4E26A4574814201836DAED9C8D510926438AA356F63B67061F5D948A187796FA7AC4FE32A44C2B57176B8BA65AC1AC2DF7DB117B35A45CE3E17924E2AE82DF92EC6DCF691293539AC52E47F47CA8EE3478907F6D239DA2AFD67B64BD44DB022F61702106EB9BAB564FF2CC9D8610D4ABDBBB32EA968AC87A53A5ED23C396C5A8A416CE6B992E98CEA65E9980D4B474A334F851E857556CE866839C3542964E21BBBAEEF1106E19743D74B1BB4A8D0B6DCAC5D0CDE3D743CA729B996D284979EE19214B24F2C455C770060369F43F717C308B9D1E62A0BCEB850C5B63820F8691F4CE5A96989502324C4E81DA713E483764CDC0010A4D6F1F482C5F33A91980F510F8B9863395E7E4B97FE0F11CF37DB6EE543581AF22F8168D0068C491CC99C7C6273BD1AEF14D9A0FF8337CF4C0BC5C33122A24DD3D0E2A5EA3B84A3A0D777CBA4171F2DEB0D93D4900E8C44DB20F1881B69DE1334711D83AAF55C44FA84285858F6948A8D1B1021DC26EBCD93FD44C7F9A3BC635EB4F3EF4E6B69FEAB7DE0463B26E2F6D32D44B3BF6328FBE972155C61E46254E9DC36A78918854B2EAF68D60DC8CCC37C4077B019C8E715492247CC560C85C5108A321A8169206968C2665B7F6838651932A67275E3B3562A842A4AB652725F1795E1816326A4281F30695C6354973B6F948BE4396D43C9710BBA640FE81F31ECFB482AE50A62B76297C9F5F4E5EBE7A6E67582BEE4169CE9A33827B1A3BD218DDDD418388262FA187DE5C215FDFB142BAC6FD22F1BDF1F8E54B6FCA431E839955B3A67CFE2E5202DAA6B053547FFDF006F301A1513AE619F77D059EDB868AB59F695AAA8767A764874FC0DA2A6FB01441E5EC3ADFDA84DDED69B4E503BFA67E4B8B1A52D29D62C29943CA6DDF9BC61B4B6852C860AF7671473D737BC2CFAC2BFC9CBD60936E7FB8DFF76BF4464395B7590DF29EBF6193E7DBBBD03B32770FBE77C1E9AD0D8D83DBC0B4410C9F9C6D637F26678FCFFA6C694B4A00D7E19CAA94879ECE96CBB0E547E5489BB71D40DF2768B747CA367E0D50F90A4BD5F2F2D6DC7801994DBD294B1183BBC772DF9D6481DD3EFAC90E590C965D95ED43A4F720987F57E00FD09B97E7E3734F5DC7E5727C6DA19330A3D725C4988561B70A25C729AD1D25DC4F0F16359117B08549E969F8EBC9789B2E0CB21DFB304BB50A84BD1CC374C4A11EA01B1C7B0430EF6FDC51E0D71364A7B3A43D972FBE66189590E22CFEACB2F404A84D29E62E5DAC464C9E8A533607D711E311D205A0FDBB48D429FB20AE68095FCEF22FD8B918CDCE0EA6EC115F4D8567AA361CB9B30EE412D37A276639731BA0BDC9924400D36218325C0936E7BA61042C150F8640E730A198380319E6BA00529CB7CCD4E9EED6711A2AFFD233D3A5AEB00E8AD6B04851FA7C8D6863951C364765CBF2A8ACFE78B77258D415B353AD34A666B148AF5572C9DEFE3844A2C363630C8A34DD9FF268D90D64078E458EC150B6916B55B70A658C3114AC4014CB6BFE6D6AEC42192C61B335DF0781665116A67219E65194C04FA0E74224A7EC9379E083F680DD11129FB240F832E221CE71424BC55C242336CD40F1C0ABE32C92340D3B55FB0B335933853179B853851D52D659845205643D921745E623DEE38BFC01BEB3C9CA77F8C0B9662CAF5A41FD12A3D42AB2B7A2CC39A0C108636C1C0FC3D5518E5BC8118584B8F7443FB7BA7D2E758F48A0435BAA6B1CC5827E09EE2F98427D1C31713A3F6537ECBF6C05FF7E3F4A6B4B6901B84E6945FCA6D5378950F8B64785D732CA22144CC3981E6DE81D499324563590F8C0295ED95AFFAF8957C647F1DE33F1CAB8215EE98E998A54CBF179C3433FC3486EB0B72AC84255136EDDF21E85B4AD90947B7D1AB06ECAE46703BF0499BC3B8A604F2200985D22D0D9B465F5B2294DD9A1048E16EE4E2547D2A97BF853B7287DDCDD34BE68CF24D11B10C94CDE88001C488953244544D5BB5C9014083FBE28FFBC06290BD4430D0236337D46809B0934FF5E5714CD8F7959768ECB04A14C056D0830150F3A63D427B570F3361930BAF3D5F9C579498791BB869AA7B8F3AB33CEE7ED8C8D195604AB942DCD3EB03C0383FF16F9CC1B86F1CF4275CD965CA7C5C645F039BA77324005D7D47F50DD1395C581972DD7D63D50D7B1A93D65C1B6546B4FAF55CC80C0BED418FB192AAD5DFB03CE06577D8D161E700BA66B762757142F58C123E91F44612A7154C534D0869B9A8FA47C08A4CCE7DE0A2B57F273748B746E0D5E0A16C748D1F7EF7FD65D74C668644AF66E33729A3DE25E9F69C7E96E93ACA62FA6B8541DADFA51812A6A50F3A2AA14B261A92571D8BBDD7586C7AD709CEAEAC84C261AFDD8D8C3D5345B055C4102980B2F852249680BB0596623DB2F6EA4C6D8DF588C9808B5B00B9E9A96E51AAB0247B7780BB7B827665D70188278B2B54C6D02D6CFDD3BF94888568656F6143E0EDD78C1018A29AF50440BDC2463D3D5C4DA103C3E3F4F4CCA034659F46DE7F948DBB3F32D3D5057810446CB38B8AF02E3A7716B233442F4AD6F96DA6A969B67766F785E7805D217C885E135987119EEA90654FA0CFAA31D0FD001AA39B9F835E3A197AAD69C938A40B0C2D022C41E656279D958E437CB6F9598094DBAF3625CD942641BB7621C2D4FF695870DEE511B5F9C1D8A7604F578438767B2634CC55737E6D0530F30EB83AC396DB9277423423727EDD1AA575EEDCFAA234E2EB1DAE8160FFD996ED36EF5A8FBE01BB30BBBA23AA596D52CBE3D6048D7A3692AA6DE24C04F5AB5C2FCB13A5C30C95DA8D73C75CA416AD2809645AB7A40258AA4192EEB551301C682E93B305C3BDA7EED991E64049F556ED442011DE76D51170BDB076F7BA252EE11936B7B1ADD125826538F5FCD7B567F102C9EC87401ED913EE3D08F802B89F6DF1C98B21AE1C27B39D1531D488FCCB82B1F8A1DCC18DC0C476F83D8BB2E6657624D00B53E547D215B0B38FF91220CAC8B0C5F0146A6EC7AA160E4D68D5F3E1151B3BA2A61E440A11B77732B90EE8413E1D007544FF04D7AADFA91D1A7EC03320C274FAE791218D3FAA878D6172383F075C4C934B437A6999B1086DF4B187AC7A9D55D97D2DE7F4A6193D740D23A32B181C954C63C593520C9747E2C817D3DC3A53E1C174113172A78E0984D7A419B854AB5A2622B06CBD8A08106ABEC6B1F98B53228F4E2049CE88149DCF8D8F6A958A17B416E087EF2C1EB1C35BB0F9779B446E5E64241AD13F02122C1E3610E8409E17FFA547F4DD26737EC1BB67AFEF4E963F62AE6EE20550459C6ADBEB282F298BD6037C3DC31D35DDE5E6FB91328D8EA3E54C2D6F8C1D103866A6E5CD907AF8EA13B988B1051F3F1D91A507C1545B4E4F16830A146AF8165A063F0A850E9EFF8FB03CDD6BBE0E57688C76488FBE2C210B565FB64581B9E7E939F6248C1E8C89FD51DF3E7B630EB0B10B798654ED09E99B57837D19ED7715DB16759ACE53CC6E35CB906B7C2C6D93DAFF8F1331EA94C331ECE95D1E6DF4E72975F9AC3ACA72BA6C13F4D20C76F278F4D1AD073F64FFDA05FB5C620123A023C07654649F76CBA672788A8F9CE904113F000ADF13A3686E54B27DA84BD1352C5F1C2CEC55439C360832B91E0513749651B6A799EFC5CE15696A9BAA25D13C5C50F95C3DF8E8B271B081BA4986F0BAB08D4EE0EC3977DFBC22A393A7AC99C0251DE5B06B90C8F84B8DF84E80DFAAEB2A415FF5DAABD8903CFEF43D8AFB4A71852555D4F3A0A783301F78582AB2410C954A94BEF6AE25D7100BD38EBA121EC8FAD7332DE63DE1F20EFA709CE6C957F8E197DE9605D5E59E9FCB8861A7AB55DF4F5BB40DE56EA3CDC0B31A75A6C5AD6FBFCAC0BB3DA8987210E2EB17E18C5D0123F62AE4DD6CE50DCBB1E5D5161D0B8C120B7550905F22D111197311A177B8A467C05BE68D741A264126C62967CFCE73B5CC19CD1E108E6940BADC2808ED1E3EC57F8FAA7C9C1C84795DFDB19352514604AAF3A95CEBEAA1C94F2309B483F312C2BD35DCDC4D7CCBCBECF8DECB4B1B681A66DEB584F72EC1434F0BAAAD2F71582B5EDC3B3BD2C6BE1A72FE495680D1928E61B53321C959A45A71AD3D12730597158FAC0B0006746CE566811ED312E961C1ECF8FE2E8508092FB95939070839C75A67C73D3943D90FF1315F1697C9BC11965ABB63C8D6A8BF3958A834AD608A5AA912EF8DD9163A235F2FF80F7F0717629562F4C5CCC92CBA438B999FC5D1099A2F80F20A8B9C9299F6AB9C450CBDA71C8D5D8F5BD93178AEB7612F2BA5807A1DE983DA87C1BB67F27E0F0B771EB3C2CFA9AD252BC5213D24322B58183B451F057D7313CD44427ED52097E25F5FE4BD59E7B42A3F01152807B6D121807A7300E23A69638E6C253572AFCCB6F79BADDBDD05F46ECF339FE373E5B7F5386E364E02D0FFBB537654C8A6A6F76EE9BACF8F69BDAB3E119EA7778D9978DB07B4C80D10146727B19120E221E75491E90CBC3E73D340C61941ED67B2807090150691EDF0D1F898ADF121FC7EBF9787E083E9EEFC04710CD2D1C998EC2BEEF04EEB0A984502773D7D9D9CA74562067EDED3F340CC993304C221261273C72237CB87B636D9336887EB5393689E45E87101D64E385A96B286A67744DBADCDD29239C8AF0A67202D0755B44A42077B957DAA26B9CFD50CD31BC167C84082F8FDEE1AC7BFA52D7DE48D302062D35A57DC7685708A32E76C55AF96A17C59577BF8CDC4563D5D7948C49BEC3138346349D8DB7A1609C7657B91778B3A0DBE081459A0CDA2FFA702ED9488455BFD6F98A0D40692C591CA888DE246DD34BE931B02BA7169F733CDA7B53FD72176ADD32A43BC9F4A7D40CCF6EA3EBCE96014F2D348505F4121297639E3EADA9307DA0B87A0AF399CB8CED9971BC685D537349435B5A5DD971B0BDB68A38A8FA20B5565040A10DD8926643BAC1A08BCBDFF673194879316C67385EC4D95B259D5FD5B9BE52EBAF99BB38C8BEE93E1AA7351A9BBA33BA8A9E34872A37585FAA9C74AB6BDA54575B6A59223CDCB04B7BF2E5C9FF01989717D2011BFFE5282F43E495B402706170706C69636174696F6E2F6A736F6E03676465666C617465" 
//   console.log(str.toLocaleLowerCase())

// } 

// redOpMeta() 

async function test3(){ 

   //Building Expression
   const strategyExpression = path.resolve(
    __dirname,
    "./src/2-price-update.rain"
  ); 

const strategyString = await fetchFile(strategyExpression);    

    console.log("opmeta here:",opMetaHash) ;
    const store = new MetaStore();
    await store.updateStore(opMetaHash);  
   let res =  await rainlangc(strategyString,["calculate-source","handle-source","calculate-batch"],store) 
   console.log("res : " , res)

} 
// test3() 

async function test4(){ 

  const config = {
    apiKey: "WLWVvo6m4MXAZ3GkzmMI8ZnLIg_bBNaO", // Replace with your API key
    network: Network.MATIC_MAINNET, // Replace with your network
  };
  
  // Creates an Alchemy object instance with the config to use for making requests
  const alchemy = new Alchemy(config); 

  //Call the method to return the recommended fee data to use in a transaction.
  const gasDataForPolygon = await alchemy.core.getFeeData()  

  console.log("gasDataForPolygon : " , gasDataForPolygon.gasPrice?.toString() ) 

  let res = await axios.get(
    "https://api.blocknative.com/gasprices/blockprices?chainid=137",
    {headers: {
        "Authorization" : "49281639-8d0e-4d3c-a55a-71f18585deef"
      }
    }
  )  
  // console.log("res.data : ",  res.data) 
  let gasPrice = ethers.utils.parseUnits(`${res.data.blockPrices[0].estimatedPrices[0].price}`,9)
  let maxPriorityFeePerGas = ethers.utils.parseUnits(`${res.data.blockPrices[0].estimatedPrices[0].maxPriorityFeePerGas}`,9)
  let maxFeePerGas = ethers.utils.parseUnits(`${res.data.blockPrices[0].estimatedPrices[0].maxFeePerGas}`,9)  
  
  console.log("gasPrice: ",  gasPrice.toString()) 

}  
export function randomUint256(): string {
  return ethers.utils.hexZeroPad(ethers.utils.randomBytes(32), 32);
}  
// test4()  
console.log(randomUint256())
console.log(typeof randomUint256())

//92 162649804
//99000000000 

function test5(){
  let arr = [
    '--token',
    'USDT',
    '--amount',
    '10',
    '--vault',
    '0xffce84569ef60565c35695f81b3b40e3c0805d77b636770dc6fb4a90425d6582'
  ] 

  let arr2 = arr.splice(2,4) 
  console.log(arr2)
} 
test5()